{"version":3,"sources":["ServerAddressForm.tsx","LoaderForm.tsx","App.tsx","index.tsx"],"names":["ServerAddressForm","props","handleChange","bind","handleSubmit","event","this","onChange","target","value","preventDefault","onSubmit","action","method","htmlFor","type","address","React","Component","LoaderForm","formElem","createRef","current","submit","style","display","ref","url","encType","id","name","token","App","handleInputChanged","state","serverAddress","startLoading","wopiUrl","setState","locationOrigin","window","location","origin","scheme","startsWith","wopiClientHost","wopiSrc","fetch","then","response","json","data","wopiClientUrl","accessToken","console","log","alert","loaderForm","className","title","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"8PA+BeA,E,kDA5BX,WAAYC,GAAa,IAAD,8BACpB,cAAMA,IACDC,aAAe,EAAKA,aAAaC,KAAlB,gBACpB,EAAKC,aAAe,EAAKA,aAAaD,KAAlB,gBAHA,E,gDAMxB,SAAaE,GACTC,KAAKL,MAAMM,SAASF,EAAMG,OAAOC,S,0BAGrC,SAAaJ,GACTA,EAAMK,iBACNJ,KAAKL,MAAMU,a,oBAGf,WACI,OACI,uBAAMC,OAAO,GAAGC,OAAO,MAAMF,SAAUL,KAAKF,aAA5C,UACI,wBAAOU,QAAQ,0BAAf,qCAEI,uBAAOC,KAAK,OAAON,MAAOH,KAAKL,MAAMe,QAAST,SAAUD,KAAKJ,kBAEjE,uBAAOa,KAAK,SAASN,MAAM,iC,GAvBXQ,IAAMC,WC0BvBC,E,kDAvBX,WAAYlB,GAAa,IAAD,8BACpB,cAAMA,IAHOmB,cAEO,EAEpB,EAAKA,SAAWH,IAAMI,YAFF,E,qDAKxB,WACQf,KAAKc,SAASE,SACdhB,KAAKc,SAASE,QAAQC,W,oBAG9B,WACI,OACI,qBAAKC,MAAO,CAACC,QAAS,QAAtB,SACI,uBAAMC,IAAKpB,KAAKc,SAAUR,OAAQN,KAAKL,MAAM0B,IAAKC,QAAQ,sBAAsBf,OAAO,OAAOL,OAAO,0BAC/FqB,GAAG,wBADT,UAEI,uBAAOC,KAAK,eAAerB,MAAOH,KAAKL,MAAM8B,MAAOhB,KAAK,SAASc,GAAG,iBACrE,uBAAOd,KAAK,SAASN,MAAM,c,GAnBtBQ,IAAMC,WCmFhBc,E,kDA/EX,WAAY/B,GAAa,IAAD,8BACpB,cAAMA,IACDgC,mBAAqB,EAAKA,mBAAmB9B,KAAxB,gBAC1B,EAAKC,aAAe,EAAKA,aAAaD,KAAlB,gBACpB,EAAK+B,MAAQ,CACTC,cAAe,GACfC,cAAc,EACdC,QAAS,GACTN,MAAO,IARS,E,sDAWxB,SAAmBf,GACdV,KAAKgC,SAAS,CAACH,cAAenB,M,0BAGnC,WAAgB,IAAD,OACLuB,EAAiBC,OAAOC,SAASC,OACjCC,EAASJ,EAAeK,WAAW,SAAW,QAAU,OAExDC,EAAiBvC,KAAK4B,MAAMC,cAClC,GAAKU,EAIL,GAAKA,EAAeD,WAAW,QAI/B,GAAKC,EAAeD,WAAWD,EAAS,OAAxC,CAKA,IAAMG,EAAO,UAAOP,EAAP,iBAEbQ,MAAM,wBAAD,OAAyBF,IACzBG,MAAK,SAAAC,GAAQ,OAAIA,EAASC,UAC1BF,MAAK,SAAAG,GACF,IAAMC,EAAgBD,EAAKxB,IACrB0B,EAAcF,EAAKpB,MACnBM,EAAO,UAAMe,EAAN,mBAA8BN,GAC3CQ,QAAQC,IAAR,mBAAwBlB,IACxB,EAAKC,SAAS,CACVF,cAAc,EACdC,QAASA,EACTN,MAAOsB,YAhBfG,MAAM,0FAJNA,MAAM,kGAJNA,MAAM,+B,gCA6Bd,WACQlD,KAAK4B,MAAME,cACX9B,KAAKgC,SAAS,CAACF,cAAc,M,oBAIrC,WACI,IAAIqB,EAQJ,OAPInD,KAAK4B,MAAME,eACXqB,EAAa,cAAC,EAAD,CACT9B,IAAKrB,KAAK4B,MAAMG,QAChBN,MAAOzB,KAAK4B,MAAMH,SAKtB,sBAAK2B,UAAU,MAAf,UACI,cAAC,EAAD,CACI1C,QAASV,KAAK4B,MAAMC,cACpB5B,SAAUD,KAAK2B,mBACftB,SAAUL,KAAKF,eAClBqD,EACD,wBAAQE,MAAM,0BAA0B9B,GAAG,0BAA0BC,KAAK,mC,GAzExEb,IAAMC,WCAxB0C,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,W","file":"static/js/main.48e34aaf.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nclass ServerAddressForm extends React.Component<any, any> {\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.handleChange = this.handleChange.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n    }\r\n\r\n    handleChange(event: any) {\r\n        this.props.onChange(event.target.value);\r\n    }\r\n\r\n    handleSubmit(event: any) {\r\n        event.preventDefault();\r\n        this.props.onSubmit();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <form action=\"\" method=\"get\" onSubmit={this.handleSubmit}>\r\n                <label htmlFor=\"collabora-online-server\">\r\n                    Collabora Online Server:\r\n                    <input type=\"text\" value={this.props.address} onChange={this.handleChange} />\r\n                </label>\r\n                <input type=\"submit\" value=\"Load Collabora Online\" />\r\n            </form>\r\n        );\r\n    }\r\n}\r\n\r\nexport default ServerAddressForm;\r\n","import React from 'react';\r\n\r\nclass LoaderForm extends React.Component<any, any> {\r\n    private readonly formElem: React.RefObject<HTMLFormElement>;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.formElem = React.createRef();\r\n    }\r\n\r\n    componentDidMount() {\r\n        if (this.formElem.current)\r\n            this.formElem.current.submit();\r\n    }\r\n\r\n    render() {\r\n        return(\r\n            <div style={{display: \"none\"}}>\r\n                <form ref={this.formElem} action={this.props.url} encType=\"multipart/form-data\" method=\"post\" target=\"collabora-online-viewer\"\r\n                      id=\"collabora-submit-form\">\r\n                    <input name=\"access_token\" value={this.props.token} type=\"hidden\" id=\"access-token\"/>\r\n                    <input type=\"submit\" value=\"\"/>\r\n                </form>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LoaderForm;\r\n","import React from 'react';\r\nimport './App.css';\r\nimport ServerAddressForm from './ServerAddressForm'\r\nimport LoaderForm from './LoaderForm'\r\n\r\nclass App extends React.Component<any, any> {\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.handleInputChanged = this.handleInputChanged.bind(this);\r\n        this.handleSubmit = this.handleSubmit.bind(this);\r\n        this.state = {\r\n            serverAddress: '',\r\n            startLoading: false,\r\n            wopiUrl: '',\r\n            token: ''\r\n        };\r\n    }\r\n    handleInputChanged(address: string) {\r\n         this.setState({serverAddress: address});\r\n    }\r\n\r\n    handleSubmit() {\r\n        const locationOrigin = window.location.origin;\r\n        const scheme = locationOrigin.startsWith('https') ? 'https' : 'http';\r\n\r\n        const wopiClientHost = this.state.serverAddress;\r\n        if (!wopiClientHost) {\r\n            alert('No server address entered');\r\n            return;\r\n        }\r\n        if (!wopiClientHost.startsWith('http')) {\r\n            alert('Warning! You have to specify the scheme protocol too (http|https) for the server address.')\r\n            return;\r\n        }\r\n        if (!wopiClientHost.startsWith(scheme + '://')) {\r\n            alert('Collabora Online server address scheme does not match the current page url scheme');\r\n            return;\r\n        }\r\n\r\n        const wopiSrc =  `${locationOrigin}/wopi/files/1`;\r\n\r\n        fetch(`/collaboraUrl?server=${wopiClientHost}`)\r\n            .then(response => response.json())\r\n            .then(data => {\r\n                const wopiClientUrl = data.url\r\n                const accessToken = data.token;\r\n                const wopiUrl = `${wopiClientUrl}WOPISrc=${wopiSrc}`;\r\n                console.log(`wopiUrl: ${wopiUrl}`)\r\n                this.setState({\r\n                    startLoading: true,\r\n                    wopiUrl: wopiUrl,\r\n                    token: accessToken\r\n                })\r\n            })\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        if (this.state.startLoading) {\r\n            this.setState({startLoading: false})\r\n        }\r\n    }\r\n\r\n    render() {\r\n        let loaderForm;\r\n        if (this.state.startLoading) {\r\n            loaderForm = <LoaderForm\r\n                url={this.state.wopiUrl}\r\n                token={this.state.token}\r\n            />\r\n        }\r\n\r\n        return (\r\n            <div className=\"App\">\r\n                <ServerAddressForm\r\n                    address={this.state.serverAddress}\r\n                    onChange={this.handleInputChanged}\r\n                    onSubmit={this.handleSubmit}/>\r\n                {loaderForm}\r\n                <iframe title=\"Collabora Online Viewer\" id=\"collabora-online-viewer\" name=\"collabora-online-viewer\">\r\n                </iframe>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}